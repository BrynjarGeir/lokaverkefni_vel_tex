% Chapter 1

\chapter{Introduction} % Main chapter title

\label{Chapter1} % For referencing the chapter elsewhere, use \ref{Chapter1} 

%----------------------------------------------------------------------------------------

% Define some commands to keep the formatting separated from the content 
\newcommand{\keyword}[1]{\textbf{#1}}
\newcommand{\tabhead}[1]{\textbf{#1}}
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\file}[1]{\texttt{\bfseries#1}}
\newcommand{\option}[1]{\texttt{\itshape#1}}

%----------------------------------------------------------------------------------------
Wind gusts are brief increase in wind speed (lasting seconds) as compared to mean wind speed. The gust factor is defined as the peak gust divided by the mean wind speed over some defined time period. The peak wind gust is often defined as the highest 3 second rolling average measured wind speed over a period of 10 minutes, while the mean wind is the average of all measurements in the 10 minute interval. This varies, with the US using a 1 minute interval, leading to 14\% higher results \cite{why_wind_gusts}. As the Navier Stokes Equation (\ref{eq:navierstokes}) shows the variability of the wind, in time and space, is dependent upon the pressure gradient, the oscillating force of the earth, and resistance. It states that the change in wind is described by the pressure gradient, the oscillation, the acceleration due to gravity and the resistance from the landscape.

\begin{equation}
    \label{eq:navierstokes}
    \frac{\delta \mathbf{V}}{\delta t} + \mathbf{V}\cdot\nabla\mathbf{V} = \underbrace{-\frac{1}{\rho}\nabla P}_{pressure} -\overbrace{ f\mathbf{k}x\mathbf{V}}^{oscillation} - g - \underbrace{\frac{\delta(u'\omega')}{\delta z} - \frac{\delta(v'\omega')}{\delta z}}_{resistance}
\end{equation}

Equation \ref{eq:navierstokes} relates the change in wind w.r.t. time ($\frac{\delta \boldsymbol{V}}{\delta t}$) and change in wind w.r.t. position ($\nabla\boldsymbol{V}$) to pressure change w.r.t. position ($\nabla P$). The wind is also influenced by the oscillation, gravity and resistance but the main drive of wind is pressure gradient\cite{uncertainties_in_numerical_weather_predictions}.

Traditionally, numerical weather prediction (NWP) systems are used to forecast and analyze weather patterns\cite{medium_range_3d_weather_forecasting_NN}. These models describe the transition between discretized packages of atmospheric states using partial differential equations based on physical reality. These results are usually published for 3-6 hour intervals.They describe the state over the period and so do not necessarily grasp fluctuations well. These fluctuations would include fluctuations in the wind speed, wind gusts\cite{canNNBeatNWPw}.

This thesis looks at how best to predict gust factor based on various factors, using several different data sources, including NWP and observations. NWP forecasts or outputs analysis, traditionally, at intervals of around 3-6 hours and thus, alone, do not capture the variability that is the essence of wind gusts. This is why another model that uses the information produced by the NWP along with observations and landscape information, is needed to try to accurately predict wind gusts. Being able to accurately predict the wind gust is important as it is often the peak wind gusts that will cause failures in structures. A problem that will become increasingly prevalent in the near future\cite{nasa_extreme_weather}.

%This thesis looks at how best to predict gust factor based on wind speed, wind direction, pressure and temperature at different heights above ground, as well as the elevation of the landscape over an area in the direction the wind is coming from. A neural network (NN) was constructed to predict the gust factor. 

\section{Background}
 The history of numerical weather predictions goes all the way back to the 1920's when Lewis Fry Richardson pioneered the field and tried to produce forecasts. The results were flawed and impractical because of the time it took to calculate was much longer than the forecast period. In the 1950's, with the advent of computers we get the first operational forecasts. In September of 1954, Rossby and his Stockholm based team produced the first real-time barotropic forecasts. The next year the Joint Numerical Weather Prediction Unit (JNWPU), based in Princeton New Jersey, released their first forecasts. These forecasts were for 36 hours at 400, 700 and 900 mb. The results were inferior to subjective human-based forecasts but showed that such forecasts were feasible and promoted further development in the area \cite{historyNWP}. The field underwent significant transformation over the next 50 years, and predictions got significantly better.

Currently there has been another transformation in the field of weather prediction driven by artificial intelligence. Interest in AI has come in waves. Some progress is made, then interest dwindles. The interest has been increasing steadily since 2010. Notable work that has driven this wave of interest include increase in computational abilities due to parallel processing in graphical processing units (GPU), convolutional neural networks (CNN), which allowed much faster processing of massive (image) datasets and the availability of large datasets online. It is to be noted that images are grid data with some number of channels. Using CNNs could work on any gridded data where there is some spatial features\cite{canNNBeatNWP}. Since 2018, there has been significant work done in the weather prediction field using AI. In 2018, Dueben and Bauer showed that you can build a NN that can outperform a simple persistence forecast and is competitive with very coarse-resolution atmosphere models of similar complexity for short lead times\cite{dueben2018}. Also in 2018, Scher created a deep convolutional neural network (CNN) to emulate a general circulation model (GCM, a numerical model representing the physical processes), training on the GCM which allows it to emulate the dynamics of the model and maintain stability for much longer than Dueben\cite{scher2018}. These two papers were more proof of concept rather than production ready models to replace NWP. They showed that models based on deep learning might, with further development, compete with standard models in the field. 

In the last two years there have been even more developments with the emergence of Large AI Weather forecast Models (LWM). In 2024 Ling et al. tried to standardize the definition of LWM in meteorology and came up with 3 rules that need to be met to count as LWM.

\begin{enumerate}[label = Rule \arabic*:]
    \item Large Parameter Count. The number of parameters can vary wildly but a general range might be from tens of millions to billions of parameters
    \item Large Number of Predictands: predicting on different levels (such as pressure levels or height levels) and offering detailed information on the atmospheric vertical structure and surface conditions
    \item Scalability and downstream applicability. This might crystallize in predicting cyclones. Often, the teams responsible for creating these models try to show their applicability to predict cyclones when not trained specifically on cyclone data (e.g.  \href{https://www.youtube.com/watch?v=PD1v5PCJs_o&ab_channel=GregBronevetsky}{GraphCast})\cite{SecondRevolution}. This is done to show the versability of the models.
\end{enumerate}

Before 2022, LWM had been shown to be able to compete with traditional NWP for some specifc cases as well as making predictions quicker, after training. No model had shown that it could in any way completely replace the traditional systems. In early 2022, Pathak et al. presented FourCastNet. FourCastNet uses an Adaptive Fourier Neural Operator model that leverages transfomer architecture rather than the popular convolutional model architechture. FourCastNet matches the performance of standard forecasting techniques at short lead times for large-scale variables and outperforms for smaller variables. It generates a week-long forecast in less than 2 seconds, orders of magnitude faster than standard physical methods\cite{FourCastNet}. In 2022, machine learning methods were presented that made predictions much faster than traditional NWP, after a one time training (or at least training that wouldn't have to be redone often). These were in some cases performing better than NWP.  In 2023, Remi Lam and the GraphCast team at Google introduced GraphCast. This model was able to outperform the industry standard High Resolution Forecast (HRES) produced by the European Centre for Medium-Range Weather Forecasts (ECMWF). This model as the name suggests leverages graphing connections rather than traditional grid like data structure. The base data is given in latitude and longitude degrees at a resolution of 0.25 degrees. This means points are closer to each other at the poles. Using the graphing structure is supposed to help with bias incurred as a result of this\cite{GraphCast}.

There has been a lot of progress made over the last 6 years (since 2018) and especially in the last 2 years (since 2022). The progression from machine learning methods being an interesting idea in the field of numerical weather predictions, to outperforming the standard NWP has been remarkably quick. Two years ago, machine learning methods were able to predict quickly and in some niche cases outperform traditional models. They were not generally competitive with standard weather models. Now they are competitive. It will be very interesting to watch what the next few years will have in store for the development of machine learning in weather predictions.

\section{Methodology and related work}

This study looks at data from three sources and an attempt is made to predict the gust factor in a given place in Iceland. It uses reanalysis data, along with elevation data to predict the gust factor. It looks at the data at the point of interest and does not look at the data as a time series. This thesis tries to improve on the baseline model of always predicting the mean and show that some structure can be learned from reanalysis data about gusts. To do this a neural network was created. The goal of this neural network was to predict the gust factor and improve upon a baseline of always guessing the mean gust factor. This baseline model gave an average error of around 10\%. Any significant improvement on this would indicate that the final model has something to contribute.

In 2004, H.Ágústsson and H. Ólafsson looked at the variability of gust factor in complex landscapes. They looked at data from automatic weather stations that measure wind at 10 meters above ground. A common definition of wind gust is the average 1 second measured wind over three seconds. This is a rolling average. A common definition of average wind is the average of the measured wind over 10 minutes. These are the definitions used both by H. Ágústsson and H. Ólafsson in 2004 as well as this study. The data that was studied in 2004 comes from the same source as used in this study, but limits itself to a smaller section. They only looked at the years 1999-2001. They looked at three factors and how these effected the gust factor. These were $d_m, D, H$, that is direction of wind blowing off a mountain, distance to the mountain and the height of the mountain above the weather station. Their main results were these, gust factor is inversely correlated to the distance from a mountain and correlated to the height of the mountain. The study in 2004 looked at the effect of a dominant point upwind. It did not look at the effects of the landscape more broadly. In this study, landscape upwind is looked at along with landscape downwind. Both the upwind and downwind landscape can influence the gustiness at a certain point \cite{GNP_vidtal}.

To be able to capture the patterns in the data we construct a neural network. The choice to select a neural network is one that is made because they are known to capture well patterns in complex data and can be applied to varied problems. This comes in handy when training on different types of data. It is also easy to construct different types of neural networks and see how they fit well with parts of the dataset. To measure the performance of these models, both to train and test, mean absolute percentage error was used. This measures the average percentage error. This was chosen because the target is the gust factor (the wind gust over the average wind). If the target would have been the wind gust rather than the gust factor then something like mean absolute error might be more appropriate.